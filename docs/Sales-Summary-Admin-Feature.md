# Sales Summary by User - Admin Feature

## Overview
This feature provides a comprehensive sales performance tracking system for administrators to monitor user sales activities and revenue generation.

## Features

### 1. User Performance Dashboard
- **Total Income Tracking**: View cumulative revenue generated by each user
- **Transaction Counting**: Track the number of sales transactions per user
- **Item Sales Monitoring**: Count total items sold by each user
- **Average Order Value**: Calculate and display AOV for performance insights

### 2. Advanced Filtering
- **Date Range Selection**: Filter data by custom start and end dates
- **User-Specific Filtering**: Focus on individual user performance
- **Transaction Type Analysis**: Breakdown by different transaction types (standard, special offers, etc.)

### 3. Interactive Features
- **Detailed Transaction View**: Click "View Details" to see individual transactions
- **Export Capabilities**: Download CSV reports for external analysis
- **Real-time Refresh**: Update data with current information
- **Responsive Design**: Works on desktop and mobile devices

### 4. Performance Metrics
- **Summary Cards**: Quick overview of total income, transactions, and items sold
- **User Rankings**: Automatic sorting by revenue performance
- **Transaction Type Breakdown**: Visual indicators showing different sale types
- **Status Tracking**: Monitor order completion and cancellation rates

## File Structure

### Frontend Components
- `/app/admin/sales-summary/page.tsx` - Main sales summary page component
- Updated menu system in `lib/menu-list.ts`
- Permission mappings in `components/admin-panel/collapse-menu-button.tsx`

### Backend Functions
- `getSalesSummaryByUser()` - Aggregate sales data by user for date ranges
- `getUserSalesTransactions()` - Fetch detailed transactions for specific users  
- `getActiveSalesUsers()` - Get list of users who have made sales

### Data Models
```typescript
interface UserSalesSummary {
  userId: string;
  displayName?: string;
  email?: string;
  totalIncome: number;
  transactionCount: number;
  itemCount: number;
  avgOrderValue: number;
  transactionTypes: { [key: string]: number };
}
```

## Usage

### Accessing the Feature
1. Navigate to Admin Panel in the main menu
2. Click "สรุปยอดขายผู้ใช้" (Sales Summary by User)
3. Requires admin permissions with "admin" module and "read" action

### Filtering and Analysis
1. **Set Date Range**: Use the start and end date filters to specify the analysis period
2. **Select User**: Choose "All Users" for overview or specific user for detailed analysis
3. **View Results**: The table shows performance metrics sorted by total income
4. **Export Data**: Click "Export CSV" to download the current filtered results

### Detailed Transaction View
1. Click "View Details" next to any user in the results table
2. Modal opens showing all transactions for that user in the selected date range
3. View transaction details including date, amount, items, type, and status

## Security and Permissions
- Protected by `ProtectedRoute` component
- Requires "admin" module access with "read" permissions
- User data is properly sanitized and permissions are verified
- Only authorized admin users can access sales summaries

## Performance Considerations
- Firestore queries are optimized with proper indexing
- Date range filtering reduces data load
- User information is cached to minimize repeated database calls
- Pagination ready for large datasets (currently limited to 1000 transactions)

## Future Enhancements
- Add chart visualizations for trends over time
- Implement commission calculations
- Add performance comparison features
- Export to additional formats (PDF, Excel)
- Real-time notifications for sales milestones
- Integration with payroll systems

## Technical Notes
- Uses Firebase Firestore for data storage
- Built with Next.js and TypeScript
- Styled with Tailwind CSS
- Responsive design with dark mode support
- Error handling for network issues and data loading failures
